# 数据库设计文档

## 1. 机房表（room）
| 字段         | 类型      | 说明         |
|--------------|-----------|--------------|
| id           | int       | 主键         |
| name         | varchar   | 机房名称     |
| location     | varchar   | 位置         |
| image_id     | int       | 图片资源ID   |
| description  | text      | 介绍         |

## 2. 机柜表（cabinet）
| 字段         | 类型      | 说明         |
|--------------|-----------|--------------|
| id           | int       | 主键         |
| room_id      | int       | 机房ID       |
| name         | varchar   | 机柜名称     |
| number       | int       | 机柜编号（机房下唯一）|
| row_number   | int       | 机柜所在排数 |
| column_number| int       | 机柜所在列数 |
| image_front  | int       | 正面图ID     |
| image_back   | int       | 背面图ID     |
| description  | text      | 介绍         |

## 3. 设备表（device）
| 字段         | 类型      | 说明         |
|--------------|-----------|--------------|
| id           | int       | 主键         |
| cabinet_id   | int       | 机柜ID       |
| name         | varchar   | 设备名称     |
| number       | int       | 设备编号（机柜下唯一）|
| image_front  | int       | 正面图ID     |
| image_back   | int       | 背面图ID     |
| description  | text      | 介绍         |

## 4. 接口表（interface）
| 字段         | 类型      | 说明         |
|--------------|-----------|--------------|
| id           | int       | 主键         |
| device_id    | int       | 设备ID       |
| name         | varchar   | 接口名称     |
| number       | int       | 接口编号（设备下唯一）|
| description  | text      | 介绍         |
| target_id    | int       | 指向接口ID（可空）|

## 5. 图片资源表（image_resource）
| 字段         | 类型      | 说明         |
|--------------|-----------|--------------|
| id           | int       | 主键         |
| url          | varchar   | 图片URL      |
| type         | enum      | 图片类型     |
| created_at   | datetime  | 上传时间     |

## 6. 图标标注表（marker）
| 字段         | 类型      | 说明         |
|--------------|-----------|--------------|
| id           | int       | 主键         |
| parent_type  | enum      | 所属类型（cabinet/device）|
| parent_id    | int       | 所属ID       |
| image_type   | enum      | 正面/背面    |
| x            | float     | X坐标（百分比）|
| y            | float     | Y坐标（百分比）|
| ref_type     | enum      | 关联类型（device/interface）|
| ref_id       | int       | 关联设备/接口ID|
| info         | text      | 备注         |

---

## 表关系说明
- 机房（room）1-N 机柜（cabinet）：room.id → cabinet.room_id
- 机柜（cabinet）1-N 设备（device）：cabinet.id → device.cabinet_id
- 设备（device）1-N 接口（interface）：device.id → interface.device_id
- 机柜/设备 1-N 图标标注（marker）：cabinet.id/device.id → marker.parent_id（parent_type区分）
- 图标标注（marker）N-1 设备/接口：device.id/interface.id → marker.ref_id（ref_type区分）
- 各表图片字段 → image_resource.id

## 设计说明
- 所有编号（机柜编号、设备编号、接口编号）仅在父级下唯一。
- 图片资源独立管理，主表只存图片ID。
- 图标标注采用相对百分比坐标，适应图片缩放。
- 图标与设备/接口为弱引用，主数据删除时相关图标自动删除。
- 接口指向关系为可空外键，目标接口被删时置空并提示。 